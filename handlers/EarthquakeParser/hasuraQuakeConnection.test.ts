import { HasuraQuakeConnection } from './hasuraQuakeConnection'
import QuakeParser from './quakeParser'

let hasuraUrl = 'http://localhost:8080/v1/graphql'
let password = 'admin'

describe('QuakeParser', () => {
  test('', async () => {
    let testJson = JSON.parse(`{"type":"FeatureCollection","metadata":{"generated":1617413526000,"url":"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_hour.geojson","title":"USGS All Earthquakes, Past Hour","status":200,"api":"1.10.3","count":7},"features":[{"type":"Feature","properties":{"mag":1.97000003,"place":"10 km E of Pāhala, Hawaii","time":1617412581640,"updated":1617412777350,"tz":null,"url":"https://earthquake.usgs.gov/earthquakes/eventpage/hv72410077","detail":"https://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/hv72410077.geojson","felt":null,"cdi":null,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":60,"net":"hv","code":"72410077","ids":",hv72410077,","sources":",hv,","types":",origin,phase-data,","nst":43,"dmin":null,"rms":0.119999997,"gap":158,"magType":"md","type":"earthquake","title":"M 2.0 - 10 km E of Pāhala, Hawaii"},"geometry":{"type":"Point","coordinates":[-155.376007080078,19.2189998626709,30.2099990844727]},"id":"hv72410077"},
      {"type":"Feature","properties":{"mag":1.75,"place":"14 km S of Fern Forest, Hawaii","time":1617412091060,"updated":1617412292260,"tz":null,"url":"https://earthquake.usgs.gov/earthquakes/eventpage/hv72410072","detail":"https://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/hv72410072.geojson","felt":null,"cdi":null,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":47,"net":"hv","code":"72410072","ids":",hv72410072,","sources":",hv,","types":",origin,phase-data,","nst":38,"dmin":null,"rms":0.280000001,"gap":106,"magType":"md","type":"earthquake","title":"M 1.8 - 14 km S of Fern Forest, Hawaii"},"geometry":{"type":"Point","coordinates":[-155.145492553711,19.3328342437744,0.699999988079071]},"id":"hv72410072"},
      {"type":"Feature","properties":{"mag":1.1,"place":"64 km E of Cantwell, Alaska","time":1617411550630,"updated":1617411774174,"tz":null,"url":"https://earthquake.usgs.gov/earthquakes/eventpage/ak02149tbxzr","detail":"https://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/ak02149tbxzr.geojson","felt":null,"cdi":null,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":19,"net":"ak","code":"02149tbxzr","ids":",ak02149tbxzr,","sources":",ak,","types":",origin,","nst":null,"dmin":null,"rms":1.02,"gap":null,"magType":"ml","type":"earthquake","title":"M 1.1 - 64 km E of Cantwell, Alaska"},"geometry":{"type":"Point","coordinates":[-147.6683,63.4275,17.8]},"id":"ak02149tbxzr"},
      {"type":"Feature","properties":{"mag":0.3,"place":"29 km SSE of Mina, Nevada","time":1617411091050,"updated":1617411734044,"tz":null,"url":"https://earthquake.usgs.gov/earthquakes/eventpage/nn00804207","detail":"https://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/nn00804207.geojson","felt":null,"cdi":null,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":1,"net":"nn","code":"00804207","ids":",nn00804207,","sources":",nn,","types":",origin,phase-data,","nst":8,"dmin":0.015,"rms":0.06,"gap":107.54,"magType":"ml","type":"earthquake","title":"M 0.3 - 29 km SSE of Mina, Nevada"},"geometry":{"type":"Point","coordinates":[-117.9245,38.169,11.1]},"id":"nn00804207"},
      {"type":"Feature","properties":{"mag":1.73,"place":"22 km E of Honaunau-Napoopoo, Hawaii","time":1617410753800,"updated":1617411084720,"tz":null,"url":"https://earthquake.usgs.gov/earthquakes/eventpage/hv72410057","detail":"https://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/hv72410057.geojson","felt":null,"cdi":null,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":46,"net":"hv","code":"72410057","ids":",hv72410057,","sources":",hv,","types":",origin,phase-data,","nst":33,"dmin":null,"rms":0.280000001,"gap":69,"magType":"ml","type":"earthquake","title":"M 1.7 - 22 km E of Honaunau-Napoopoo, Hawaii"},"geometry":{"type":"Point","coordinates":[-155.650497436523,19.4838333129883,-1.76999998092651]},"id":"hv72410057"},
      {"type":"Feature","properties":{"mag":1.06,"place":"9km NE of Aguanga, CA","time":1617410478440,"updated":1617410699950,"tz":null,"url":"https://earthquake.usgs.gov/earthquakes/eventpage/ci39836744","detail":"https://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/ci39836744.geojson","felt":null,"cdi":null,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":17,"net":"ci","code":"39836744","ids":",ci39836744,","sources":",ci,","types":",nearby-cities,origin,phase-data,scitech-link,","nst":47,"dmin":0.01816,"rms":0.2,"gap":31,"magType":"ml","type":"earthquake","title":"M 1.1 - 9km NE of Aguanga, CA"},"geometry":{"type":"Point","coordinates":[-116.7945,33.4948333,4.67]},"id":"ci39836744"},
      {"type":"Feature","properties":{"mag":0.91,"place":"19km E of Little Lake, CA","time":1617410363900,"updated":1617410577607,"tz":null,"url":"https://earthquake.usgs.gov/earthquakes/eventpage/ci39836736","detail":"https://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/ci39836736.geojson","felt":null,"cdi":null,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":13,"net":"ci","code":"39836736","ids":",ci39836736,","sources":",ci,","types":",nearby-cities,origin,phase-data,scitech-link,","nst":11,"dmin":0.0416,"rms":0.27,"gap":85,"magType":"ml","type":"earthquake","title":"M 0.9 - 19km E of Little Lake, CA"},"geometry":{"type":"Point","coordinates":[-117.6945,35.9266667,4.37]},"id":"ci39836736"}],"bbox":[-155.65049743652,19.218999862671,-1.7699999809265,-116.7945,63.4275,30.209999084473]}`)
    let parser = new QuakeParser()
    let output = parser.parse(testJson)

    let foo = new HasuraQuakeConnection(hasuraUrl, password)

    await foo.insertQuakes(output)
  })
})
